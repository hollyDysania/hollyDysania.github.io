<!DOCTYPE html><html class="theme-next mist" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="baidu-site-verification" content="CaEqZw1UZQsCqgsS"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/logo@2x.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/logo@2x.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/logo@2x.png?v=5.1.4"><link rel="mask-icon" href="/images/logo@2x.png?v=5.1.4" color="#222"><meta name="keywords" content="holly,侯玲,前端,vue"><link rel="alternate" href="/atom.xml" title="Holly-小站" type="application/atom+xml"><meta name="description" content="加油"><meta name="keywords" content="侯玲"><meta property="og:type" content="website"><meta property="og:title" content="Holly-小站"><meta property="og:url" content="https://www.hollytree.top/index.html"><meta property="og:site_name" content="Holly-小站"><meta property="og:description" content="加油"><meta property="og:locale" content="zh-Hans"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Holly-小站"><meta name="twitter:description" content="加油"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><title>Holly-小站</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?18e73a1d2b1353bbdc9d30039a704270";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">{ Holly-小站 }</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">holly blog</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.hollytree.top/2018/09/11/拜读及分析Element源码-radio组件篇/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="holly"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Holly-小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/09/11/拜读及分析Element源码-radio组件篇/" itemprop="url">未命名</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-11T22:40:56+08:00">2018-09-11</time></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2,270 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">11 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>title: 拜读及分析Element源码-radio组件篇<br>date: 2018-09-10 17:49:27<br>tags: element-ui<br>categories:</p><ul><li>Vue</li><li>element-ui源码分析系列</li></ul><blockquote><p>element-ui 单选框radio组件源码分析，也是很常用的一个</p></blockquote><p><img src="/2018/09/11/拜读及分析Element源码-radio组件篇/a20596dda144ad34a437870dd8a20cf430ad8552.jpg" alt=""></p><p><code>单选框组件分为3部分</code></p><ol><li>radio-group: 单选组，适用于多个互斥的选项中选择的场景</li><li>radio： 单选</li><li>radio-button: 按钮样式的单选</li></ol><p><strong>2可以单独使用，也可与1组合使用，3和1要组合使用</strong></p><h2 id="radio-group"><a href="#radio-group" class="headerlink" title="radio-group"></a>radio-group</h2><h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><p><code>很简单相当于是一个父容器，并且提供了键盘上下左右选中的方法</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"el-radio-group"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">role</span>=<span class="string">"radiogroup"</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">keydown</span>=<span class="string">"handleKeydown"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>slot接收的内容就是radio或radio-button了</p><h3 id="script部分"><a href="#script部分" class="headerlink" title="script部分"></a>script部分</h3><h4 id="1-导入mixins"><a href="#1-导入mixins" class="headerlink" title="1. 导入mixins"></a>1. 导入mixins</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/src/mixins/emitter'</span>;</span><br></pre></td></tr></table></figure><p>这是其实就是用到emitter.js里的dispatch 方法（向上找到指定组件并发布指定事件及传递值）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收组件名，事件名，参数</span></span><br><span class="line">dispatch(componentName, eventName, params) &#123;</span><br><span class="line">  <span class="keyword">var</span> parent = <span class="keyword">this</span>.$parent || <span class="keyword">this</span>.$root;</span><br><span class="line">  <span class="keyword">var</span> name = parent.$options.componentName;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 寻找父级，如果父级不是符合的组件名，则循环向上查找</span></span><br><span class="line">  <span class="keyword">while</span> (parent &amp;&amp; (!name || name !== componentName)) &#123;</span><br><span class="line">    parent = parent.$parent;</span><br><span class="line">    <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">      name = parent.$options.componentName;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 找到符合组件名称的父级后，发布其事件。</span></span><br><span class="line">  <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">    parent.$emit.apply(parent, [eventName].concat(params));</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>在watch中监听value时用到</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="comment">// 监听选中值，向上找到from-item组件发布el.form.change（应该是用于表单验证）</span></span><br><span class="line">  value(value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.dispatch(<span class="string">'ElFormItem'</span>, <span class="string">'el.form.change'</span>, [<span class="keyword">this</span>.value]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-声明-冻结上下左右的keyCode组成的对象"><a href="#2-声明-冻结上下左右的keyCode组成的对象" class="headerlink" title="2.声明 冻结上下左右的keyCode组成的对象"></a>2.声明 冻结上下左右的keyCode组成的对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> keyCode = <span class="built_in">Object</span>.freeze(&#123;</span><br><span class="line">  LEFT: <span class="number">37</span>,</span><br><span class="line">  UP: <span class="number">38</span>,</span><br><span class="line">  RIGHT: <span class="number">39</span>,</span><br><span class="line">  DOWN: <span class="number">40</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p> <strong>Object.freeze()</strong> 方法可以冻结一个对象，冻结指的是不能向这个对象添加新的属性，不能修改其已有属性的值，不能删除已有属性，以及不能修改该对象已有属性的可枚举性、可配置性、可写性。该方法返回被冻结的对象。</p><h4 id="3-若form-item组件注入属性影响size（默认为空）"><a href="#3-若form-item组件注入属性影响size（默认为空）" class="headerlink" title="3.若form-item组件注入属性影响size（默认为空）"></a>3.若form-item组件注入属性影响size（默认为空）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject: &#123;</span><br><span class="line">  elFormItem: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>size在computed里</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 最终大小</span></span><br><span class="line">computed: &#123;</span><br><span class="line">  _elFormItemSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.elFormItem || &#123;&#125;).elFormItemSize;</span><br><span class="line">  &#125;,</span><br><span class="line">  radioGroupSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size || <span class="keyword">this</span>._elFormItemSize || (<span class="keyword">this</span>.$ELEMENT || &#123;&#125;).size;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-生命周期及watch"><a href="#4-生命周期及watch" class="headerlink" title="4.生命周期及watch"></a>4.生命周期及watch</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="comment">// 触发radio组件发布的handleChange事件拿到选中值，发布change事件暴露选中值</span></span><br><span class="line">  <span class="keyword">this</span>.$on(<span class="string">'handleChange'</span>, value =&gt; &#123;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, value);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br><span class="line">mounted() &#123;</span><br><span class="line">  <span class="comment">// 当radioGroup没有默认选项时，第一个可以选中Tab导航</span></span><br><span class="line">  <span class="comment">// 不知为何要这样做</span></span><br><span class="line">  <span class="keyword">const</span> radios = <span class="keyword">this</span>.$el.querySelectorAll(<span class="string">'[type=radio]'</span>);</span><br><span class="line">  <span class="keyword">const</span> firstLabel = <span class="keyword">this</span>.$el.querySelectorAll(<span class="string">'[role=radio]'</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (![].some.call(radios, radio =&gt; radio.checked) &amp;&amp; firstLabel) &#123;</span><br><span class="line">    firstLabel.tabIndex = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-keyDown事件"><a href="#5-keyDown事件" class="headerlink" title="5.keyDown事件"></a>5.keyDown事件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">handleKeydown(e) &#123; <span class="comment">// 左右上下按键 可以在radio组内切换不同选项</span></span><br><span class="line">  <span class="keyword">const</span> target = e.target;</span><br><span class="line">  <span class="comment">// radio || label</span></span><br><span class="line">  <span class="keyword">const</span> className = target.nodeName === <span class="string">'INPUT'</span> ? <span class="string">'[type=radio]'</span> : <span class="string">'[role=radio]'</span>;</span><br><span class="line">  <span class="keyword">const</span> radios = <span class="keyword">this</span>.$el.querySelectorAll(className);</span><br><span class="line">  <span class="keyword">const</span> length = radios.length;</span><br><span class="line">  <span class="keyword">const</span> index = [].indexOf.call(radios, target);</span><br><span class="line">  <span class="keyword">const</span> roleRadios = <span class="keyword">this</span>.$el.querySelectorAll(<span class="string">'[role=radio]'</span>);</span><br><span class="line">  <span class="keyword">switch</span> (e.keyCode) &#123;</span><br><span class="line">    <span class="keyword">case</span> keyCode.LEFT:</span><br><span class="line">    <span class="keyword">case</span> keyCode.UP:</span><br><span class="line">    <span class="comment">// 上左 阻止冒泡和默认行为</span></span><br><span class="line">      e.stopPropagation();</span><br><span class="line">      e.preventDefault();</span><br><span class="line">      <span class="comment">// 第一个元素</span></span><br><span class="line">      <span class="keyword">if</span> (index === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 选中最后一个</span></span><br><span class="line">        roleRadios[length - <span class="number">1</span>].click();</span><br><span class="line">        roleRadios[length - <span class="number">1</span>].focus();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 不是第一个 则选中前一个</span></span><br><span class="line">        roleRadios[index - <span class="number">1</span>].click();</span><br><span class="line">        roleRadios[index - <span class="number">1</span>].focus();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> keyCode.RIGHT:</span><br><span class="line">    <span class="keyword">case</span> keyCode.DOWN:</span><br><span class="line">    <span class="comment">// 下右 最后一个元素</span></span><br><span class="line">      <span class="keyword">if</span> (index === (length - <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="comment">// 阻止冒泡和默认行为</span></span><br><span class="line">        e.stopPropagation();</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        <span class="comment">// 选中第一个</span></span><br><span class="line">        roleRadios[<span class="number">0</span>].click();</span><br><span class="line">        roleRadios[<span class="number">0</span>].focus();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 不是最后一个元素 则选中后一个</span></span><br><span class="line">        roleRadios[index + <span class="number">1</span>].click();</span><br><span class="line">        roleRadios[index + <span class="number">1</span>].focus();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>switch case语句没有break默认向下执行，所以上左 和 下右 分别只写了一个执行函数和break(执行相同)</p><h2 id="radio"><a href="#radio" class="headerlink" title="radio"></a>radio</h2><h3 id="结构-1"><a href="#结构-1" class="headerlink" title="结构"></a>结构</h3><h4 id="1-外层label-控制整体样式"><a href="#1-外层label-控制整体样式" class="headerlink" title="1.外层label,控制整体样式"></a>1.外层label,控制整体样式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">label</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"el-radio"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:class</span>=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">    border &amp;&amp; radioSize ? 'el-radio--' + radioSize : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-disabled': isDisabled &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-focus': focus &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-bordered': border &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-checked': model === label &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">  ]"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">role</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:aria-checked</span>=<span class="string">"model === label"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:aria-disabled</span>=<span class="string">"isDisabled"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:tabindex</span>=<span class="string">"tabIndex"</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">keydown.space.stop.prevent</span>=<span class="string">"model = isDisabled ? model : label"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>role,aria-checked,aria-disabled三个属性是无障碍页面应用的属性（读屏软件会用到）<a href="https://www.zhangxinxu.com/wordpress/2012/03/wai-aria-%E6%97%A0%E9%9A%9C%E7%A2%8D%E9%98%85%E8%AF%BB/" target="_blank" rel="noopener">参考</a></li><li>tabindex： 属性规定元素的 tab 键控制次序 ，0为按照顺序，-1为不受tab控制</li><li>@keydown.space：空格keydown事件（可查阅vue官网按键修饰符）</li></ul><h4 id="2-内层第一个span由span和不可见的input（模拟radio）组成（筛选框）"><a href="#2-内层第一个span由span和不可见的input（模拟radio）组成（筛选框）" class="headerlink" title="2.内层第一个span由span和不可见的input（模拟radio）组成（筛选框）"></a>2.内层第一个span由span和不可见的input（模拟radio）组成（筛选框）</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 单选框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-radio__input"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:class</span>=<span class="string">"&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-disabled': isDisabled,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-checked': model === label</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#125;"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-radio__inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 不可见input模拟radio --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"el-radio__original"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:value</span>=<span class="string">"label"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-model</span>=<span class="string">"model"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">focus</span>=<span class="string">"focus = true"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">blur</span>=<span class="string">"focus = false"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">change</span>=<span class="string">"handleChange"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:disabled</span>=<span class="string">"isDisabled"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">tabindex</span>=<span class="string">"-1"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>aria-hidden：也是无障碍页面应用的属性（读屏软件会用到），为true时自动读屏软件会自动跳过，毕竟这是一个隐藏元素</li></ul><h4 id="3-内层第二个span显示（筛选框对应的内容）"><a href="#3-内层第二个span显示（筛选框对应的内容）" class="headerlink" title="3.内层第二个span显示（筛选框对应的内容）"></a>3.内层第二个span显示（筛选框对应的内容）</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 单选文字 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 阻止冒泡 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-radio__label"</span> @<span class="attr">keydown.stop</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 接收到插槽，显示插槽内容 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 没有接收到插槽，显示label --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"!$slots.default"</span>&gt;</span>&#123;&#123;label&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>$slots.default ：接收匿名插槽内容</li></ul><h3 id="script部份"><a href="#script部份" class="headerlink" title="script部份"></a>script部份</h3><h4 id="1-引入mixins"><a href="#1-引入mixins" class="headerlink" title="1.引入mixins"></a>1.引入mixins</h4><p>同上 用到的是mixins中的dispatch方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用到mixins中的dispatch方法，向上寻找对应的组件并发布事件</span></span><br><span class="line"><span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/src/mixins/emitter'</span>;</span><br></pre></td></tr></table></figure><p>运用在input的change事件中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handleChange() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 发布change事件暴露model</span></span><br><span class="line">        <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, <span class="keyword">this</span>.model);</span><br><span class="line">        <span class="comment">// 如果被radio-group组件嵌套，向上找到radio-group组件发布handleChange事件暴露model</span></span><br><span class="line">        <span class="keyword">this</span>.isGroup &amp;&amp; <span class="keyword">this</span>.dispatch(<span class="string">'ElRadioGroup'</span>, <span class="string">'handleChange'</span>, <span class="keyword">this</span>.model);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>$nextTick: 将回调延迟到下次 DOM 更新循环之后执行</li></ul><h4 id="2-provide和-inject"><a href="#2-provide和-inject" class="headerlink" title="2.provide和 inject"></a>2.provide和 inject</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// form注入</span></span><br><span class="line">inject: &#123;</span><br><span class="line">  elForm: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  elFormItem: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同上，接收form组件注入属性，影响size及disabled。 (computed中可以看到)</p><h4 id="3-computed"><a href="#3-computed" class="headerlink" title="3.computed"></a>3.computed</h4><ul><li><p>是否被radio-group包裹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向上找radio-group组件 有则true无则false</span></span><br><span class="line">isGroup() &#123;</span><br><span class="line">    <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent;</span><br><span class="line">    <span class="keyword">while</span> (parent) &#123;</span><br><span class="line">        <span class="keyword">if</span> (parent.$options.componentName !== <span class="string">'ElRadioGroup'</span>) &#123;</span><br><span class="line">            parent = parent.$parent;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>._radioGroup = parent;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>实现v-model</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现v-model</span></span><br><span class="line">model: &#123;</span><br><span class="line">  <span class="comment">// 取值</span></span><br><span class="line">  get() &#123;</span><br><span class="line">    <span class="comment">// radio-group的value或value</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.isGroup ? <span class="keyword">this</span>._radioGroup.value : <span class="keyword">this</span>.value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 赋值</span></span><br><span class="line">  set(val) &#123;</span><br><span class="line">    <span class="comment">// 被radio-group组件包裹 radio-group组件发布input事件数组形式暴露值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isGroup) &#123;</span><br><span class="line">      <span class="keyword">this</span>.dispatch(<span class="string">'ElRadioGroup'</span>, <span class="string">'input'</span>, [val]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 没有被radio-group组件包裹，直接发布input事件暴露值</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, val);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>控制size,disabled,tabIndex</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">_elFormItemSize() &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">this</span>.elFormItem || &#123;&#125;).elFormItemSize;</span><br><span class="line">&#125;,</span><br><span class="line">radioSize() &#123;</span><br><span class="line">  <span class="comment">// props的size及form注入的size及全局配置对象（$ELEMENT，此对象由引入时Vue.use()传入的默认空对象）的size</span></span><br><span class="line">  <span class="keyword">const</span> temRadioSize = <span class="keyword">this</span>.size || <span class="keyword">this</span>._elFormItemSize || (<span class="keyword">this</span>.$ELEMENT || &#123;&#125;).size;</span><br><span class="line">  <span class="comment">// 被radio-group组件包裹优先radioGroupSize</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.isGroup</span><br><span class="line">    ? <span class="keyword">this</span>._radioGroup.radioGroupSize || temRadioSize</span><br><span class="line">    : temRadioSize;</span><br><span class="line">&#125;,</span><br><span class="line">isDisabled() &#123;</span><br><span class="line">  <span class="comment">// 被radio-group组件包裹，radioGroup的disabled || props的disabled || form注入的disabled,</span></span><br><span class="line">  <span class="comment">// 未被radio-group组件包裹则少第一个条件</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.isGroup</span><br><span class="line">    ? <span class="keyword">this</span>._radioGroup.disabled || <span class="keyword">this</span>.disabled || (<span class="keyword">this</span>.elForm || &#123;&#125;).disabled</span><br><span class="line">    : <span class="keyword">this</span>.disabled || (<span class="keyword">this</span>.elForm || &#123;&#125;).disabled;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 控制tab是否可以选中</span></span><br><span class="line">tabIndex() &#123;</span><br><span class="line">  <span class="comment">// 当tabindex=0时，该元素可以用tab键获取焦点，且访问的顺序是按照元素在文档中的顺序来focus</span></span><br><span class="line">  <span class="comment">// 当tabindex=-1时，该元素用tab键获取不到焦点，但是可以通过js获取，这样就便于我们通过js设置上下左右键的响应事件来focus，在widget内部可以用到。</span></span><br><span class="line">  <span class="comment">// 当tabindex&gt;=1时，该元素可以用tab键获取焦点，而且优先级大于tabindex=0；不过在tabindex&gt;=1时，数字越小，越先定位到。</span></span><br><span class="line">  <span class="keyword">return</span> !<span class="keyword">this</span>.isDisabled ? (<span class="keyword">this</span>.isGroup ? (<span class="keyword">this</span>.model === <span class="keyword">this</span>.label ? <span class="number">0</span> : <span class="number">-1</span>) : <span class="number">0</span>) : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="radio-button"><a href="#radio-button" class="headerlink" title="radio-button"></a>radio-button</h2><h3 id="结构-2"><a href="#结构-2" class="headerlink" title="结构"></a>结构</h3><p>与radio类似，label是button的样式，少了一个单选框的结构（span），input模拟radio并且不可见，另一个依旧是显示对应单选框内容的span</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"el-radio-button"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:class</span>=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">    size ? 'el-radio-button--' + size : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-active': value === label &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-disabled': isDisabled &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123; 'is-focus': focus &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">  ]"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">role</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:aria-checked</span>=<span class="string">"value === label"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:aria-disabled</span>=<span class="string">"isDisabled"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:tabindex</span>=<span class="string">"tabIndex"</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">keydown.space.stop.prevent</span>=<span class="string">"value = isDisabled ? value : label"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"el-radio-button__orig-radio"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:value</span>=<span class="string">"label"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">"value"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">change</span>=<span class="string">"handleChange"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:disabled</span>=<span class="string">"isDisabled"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tabindex</span>=<span class="string">"-1"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">focus</span>=<span class="string">"focus = true"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">blur</span>=<span class="string">"focus = false"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"el-radio-button__inner"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:style</span>=<span class="string">"value === label ? activeStyle : null"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">keydown.stop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"!$slots.default"</span>&gt;</span>&#123;&#123;label&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="script部分-1"><a href="#script部分-1" class="headerlink" title="script部分"></a>script部分</h3><p>逻辑与radio基本上一样，来看下有区别的地方</p><p>选中时的填充色和边框色</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    <span class="comment">// radio-group组件实例</span></span><br><span class="line">  _radioGroup() &#123;</span><br><span class="line">    <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent;</span><br><span class="line">    <span class="comment">// 向上寻找radio-group组件 有就返回radio-group组件实例 没有返回false</span></span><br><span class="line">    <span class="keyword">while</span> (parent) &#123;</span><br><span class="line">      <span class="keyword">if</span> (parent.$options.componentName !== <span class="string">'ElRadioGroup'</span>) &#123;</span><br><span class="line">        parent = parent.$parent;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> parent;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  activeStyle() &#123;</span><br><span class="line">    <span class="comment">// 选中时的填充色和边框色</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      backgroundColor: <span class="keyword">this</span>._radioGroup.fill || <span class="string">''</span>,</span><br><span class="line">      borderColor: <span class="keyword">this</span>._radioGroup.fill || <span class="string">''</span>,</span><br><span class="line">      boxShadow: <span class="keyword">this</span>._radioGroup.fill ? <span class="string">`-1px 0 0 0 <span class="subst">$&#123;<span class="keyword">this</span>._radioGroup.fill&#125;</span>`</span> : <span class="string">''</span>,</span><br><span class="line">      color: <span class="keyword">this</span>._radioGroup.textColor || <span class="string">''</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li>fill：是radio-group组件的属性（颜色）</li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.hollytree.top/2018/09/11/拜读及分析Element源码-checkbox多选框组件篇/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="holly"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Holly-小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/09/11/拜读及分析Element源码-checkbox多选框组件篇/" itemprop="url">拜读及分析Element源码-checkbox多选框组件篇</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-11T15:55:49+08:00">2018-09-11</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/element-ui源码分析系列/" itemprop="url" rel="index"><span itemprop="name">element-ui源码分析系列</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1,585 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">8 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>element源码分析-checkbox多选框，感觉逻辑跟单选框很像，来看看吧。</p></blockquote><p><img src="/2018/09/11/拜读及分析Element源码-checkbox多选框组件篇/b4f0267f9e2f070881b62b8ae124b899a801f2ab.jpg" alt=""></p><p><code>checkbox多选框和单选框一样也分为三部分</code></p><ul><li>checkbox-group：适用于多个勾选框绑定到同一个数组的情景，通过是否勾选来表示这一组选项中选中的项。</li><li>checkbox：多选。</li><li>checkbox-button： 按钮样式的多选。</li></ul><h2 id="checkbox-group"><a href="#checkbox-group" class="headerlink" title="checkbox-group"></a>checkbox-group</h2><p><code>相当于把checkbox和checkboxButton形成一个组</code></p><h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"el-checkbox-group"</span> <span class="attr">role</span>=<span class="string">"group"</span> <span class="attr">aria-label</span>=<span class="string">"checkbox-group"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 插槽：用来接收checkbox或checkbox-button --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="script部分"><a href="#script部分" class="headerlink" title="script部分"></a>script部分</h3><h4 id="1-接收form组件注入"><a href="#1-接收form组件注入" class="headerlink" title="1.接收form组件注入"></a>1.接收form组件注入</h4><p>默认为空，若在form组件中嵌套使用并form组件注入了elFormItem则有值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject: &#123;</span><br><span class="line">  elFormItem: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-注入的内容会在computed中使用"><a href="#2-注入的内容会在computed中使用" class="headerlink" title="2.注入的内容会在computed中使用"></a>2.注入的内容会在computed中使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">// 控制大小</span></span><br><span class="line">  _elFormItemSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.elFormItem || &#123;&#125;).elFormItemSize;</span><br><span class="line">  &#125;,</span><br><span class="line">  checkboxGroupSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size || <span class="keyword">this</span>._elFormItemSize || (<span class="keyword">this</span>.$ELEMENT || &#123;&#125;).size;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>checkboxGroupSize会在<code>checkbox</code>和<code>checkboxButton</code>中用到</p><h4 id="3-监听value"><a href="#3-监听value" class="headerlink" title="3.监听value"></a>3.监听value</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="comment">// 监听value 向上寻找form组件发布el.form.change事件暴露value（数组）</span></span><br><span class="line">  value(value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.dispatch(<span class="string">'ElFormItem'</span>, <span class="string">'el.form.change'</span>, [value]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-props接收的属性"><a href="#4-props接收的属性" class="headerlink" title="4.props接收的属性"></a>4.props接收的属性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 与v-model绑定</span></span><br><span class="line">  value: &#123;&#125;,</span><br><span class="line">  <span class="comment">// 是否禁用</span></span><br><span class="line">  disabled: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 最少勾选长度</span></span><br><span class="line">  min: <span class="built_in">Number</span>,</span><br><span class="line">  <span class="comment">// 最大勾选长度</span></span><br><span class="line">  max: <span class="built_in">Number</span>,</span><br><span class="line">  <span class="comment">// 大小</span></span><br><span class="line">  size: <span class="built_in">String</span>,</span><br><span class="line">  <span class="comment">// 边框及背景填充色</span></span><br><span class="line">  fill: <span class="built_in">String</span>,</span><br><span class="line">  <span class="comment">// 文字颜色</span></span><br><span class="line">  textColor: <span class="built_in">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有些属性checkbox和checkboxButton组件会用到</p><h2 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h2><h3 id="结构-1"><a href="#结构-1" class="headerlink" title="结构"></a>结构</h3><h5 id="1-外层label-控制外层样式"><a href="#1-外层label-控制外层样式" class="headerlink" title="1.外层label: 控制外层样式"></a>1.外层label: 控制外层样式</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">label</span></span></span><br><span class="line"><span class="tag">   <span class="attr">class</span>=<span class="string">"el-checkbox"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">:class</span>=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">     border &amp;&amp; checkboxSize ? 'el-checkbox--' + checkboxSize : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">     &#123; 'is-disabled': isDisabled &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">     &#123; 'is-bordered': border &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">     &#123; 'is-checked': isChecked &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">   ]"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">role</span>=<span class="string">"checkbox"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">:aria-checked</span>=<span class="string">"indeterminate ? 'mixed': isChecked"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">:aria-disabled</span>=<span class="string">"isDisabled"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">:id</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag"> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>role，aria-checked，aria-disabled：无障碍网页应用属性（用于读屏）<ul><li>aria-checked： true代表选中，false代表未选中，mixed代表：元素指示选定和未选择状态 。</li></ul></li></ul><h5 id="2-内层第一个span选择框"><a href="#2-内层第一个span选择框" class="headerlink" title="2.内层第一个span选择框"></a>2.内层第一个span选择框</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-checkbox__input"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:class</span>=<span class="string">"&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">    'is-disabled': isDisabled,</span></span></span><br><span class="line"><span class="tag"><span class="string">    'is-checked': isChecked,</span></span></span><br><span class="line"><span class="tag"><span class="string">    'is-indeterminate': indeterminate,</span></span></span><br><span class="line"><span class="tag"><span class="string">    'is-focus': focus</span></span></span><br><span class="line"><span class="tag"><span class="string">  &#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">aria-checked</span>=<span class="string">"mixed"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-checkbox__inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 有trueLabel或falseLabel时展示 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">...</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-if</span>=<span class="string">"trueLabel || falseLabel"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">...</span></span></span><br><span class="line"><span class="tag">   &gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 无trueLabel和falseLabel时展示 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">    <span class="attr">...</span></span></span><br><span class="line"><span class="tag">   &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>外层span控制选择框的选中未被选中样式</li><li>隐藏的input模拟checkbox: 分为有传入trueLable或falseLable与无两种结构</li></ul><h5 id="3-内层第二个span-选择框对应的内容"><a href="#3-内层第二个span-选择框对应的内容" class="headerlink" title="3.内层第二个span-选择框对应的内容"></a>3.内层第二个span-选择框对应的内容</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-checkbox__label"</span> <span class="attr">v-if</span>=<span class="string">"$slots.default || label"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">   // 有插槽内容显示插槽 无直接显示label</span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"!$slots.default"</span>&gt;</span>&#123;&#123;label&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="script部分-1"><a href="#script部分-1" class="headerlink" title="script部分"></a>script部分</h3><h5 id="从生命周期开始"><a href="#从生命周期开始" class="headerlink" title="从生命周期开始"></a>从生命周期开始</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="comment">// 如果当前勾选 调用addToStore(相当于选中与model值对应)</span></span><br><span class="line">  <span class="keyword">this</span>.checked &amp;&amp; <span class="keyword">this</span>.addToStore();</span><br><span class="line">&#125;,</span><br><span class="line">mounted() &#123;</span><br><span class="line">  <span class="comment">// 如果有被选中又不是全选</span></span><br><span class="line">  <span class="comment">// 为indeterminate元素 添加aria-controls 属性</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.indeterminate) &#123;</span><br><span class="line">    <span class="comment">// controls对应id,表示元素之间的控制关系</span></span><br><span class="line">    <span class="keyword">this</span>.$el.setAttribute(<span class="string">'aria-controls'</span>, <span class="keyword">this</span>.controls);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>addToStore方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">addToStore() &#123;</span><br><span class="line">    <span class="comment">// 如果model是数组并且不包含当前的选项，把当前选项push到model中</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        <span class="built_in">Array</span>.isArray(<span class="keyword">this</span>.model) &amp;&amp;</span><br><span class="line">        <span class="keyword">this</span>.model.indexOf(<span class="keyword">this</span>.label) === <span class="number">-1</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">this</span>.model.push(<span class="keyword">this</span>.label);</span><br><span class="line">        <span class="comment">// 否则 为传入选中值或true</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.model = <span class="keyword">this</span>.trueLabel || <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="一些计算属性"><a href="#一些计算属性" class="headerlink" title="一些计算属性"></a>一些计算属性</h5><ul><li>是否被选中</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否被选中</span></span><br><span class="line">isChecked() &#123;</span><br><span class="line">    <span class="comment">// model是Boolean类型</span></span><br><span class="line">    <span class="keyword">if</span> (&#123;&#125;.toString.call(<span class="keyword">this</span>.model) === <span class="string">'[object Boolean]'</span>) &#123;</span><br><span class="line">        <span class="comment">// 直接返回model</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.model;</span><br><span class="line">        <span class="comment">// 数组类型</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(<span class="keyword">this</span>.model)) &#123;</span><br><span class="line">        <span class="comment">// 当前的label在model中为true不在为false</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.model.indexOf(<span class="keyword">this</span>.label) &gt; <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">// model存在 返回是否与props的trueLabel全等</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.model !== <span class="literal">null</span> &amp;&amp; <span class="keyword">this</span>.model !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.model === <span class="keyword">this</span>.trueLabel;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>是否在多选组中嵌套使用</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向上找checkbox-group组件找到返回true 未找到返回false</span></span><br><span class="line">isGroup() &#123;</span><br><span class="line">    <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent;</span><br><span class="line">    <span class="keyword">while</span> (parent) &#123;</span><br><span class="line">        <span class="keyword">if</span> (parent.$options.componentName !== <span class="string">'ElCheckboxGroup'</span>) &#123;</span><br><span class="line">            parent = parent.$parent;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>._checkboxGroup = parent;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>控制样式的几个属性</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">isDisabled() &#123;</span><br><span class="line">   <span class="comment">// 取决于 checkbox-group的disabled props的disabled form注入的disabled</span></span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">this</span>.isGroup</span><br><span class="line">     ? <span class="keyword">this</span>._checkboxGroup.disabled || <span class="keyword">this</span>.disabled || (<span class="keyword">this</span>.elForm || &#123;&#125;).disabled</span><br><span class="line">     : <span class="keyword">this</span>.disabled || (<span class="keyword">this</span>.elForm || &#123;&#125;).disabled;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> _elFormItemSize() &#123;</span><br><span class="line">   <span class="keyword">return</span> (<span class="keyword">this</span>.elFormItem || &#123;&#125;).elFormItemSize;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> checkboxSize() &#123;</span><br><span class="line">   <span class="comment">// 取决于传入的size form组件注入的size 全局配置size</span></span><br><span class="line">   <span class="keyword">const</span> temCheckboxSize = <span class="keyword">this</span>.size || <span class="keyword">this</span>._elFormItemSize || (<span class="keyword">this</span>.$ELEMENT || &#123;&#125;).size;</span><br><span class="line">   <span class="comment">// 如果被checkbox-group组件包裹，优先checkbox-group组件的size</span></span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">this</span>.isGroup</span><br><span class="line">     ? <span class="keyword">this</span>._checkboxGroup.checkboxGroupSize || temCheckboxSize</span><br><span class="line">     : temCheckboxSize;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ul><li>value</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// checkbox-group组件实例的value或当前value</span></span><br><span class="line">store() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._checkboxGroup ? <span class="keyword">this</span>._checkboxGroup.value : <span class="keyword">this</span>.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>v-model对应的值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// v-model的值</span></span><br><span class="line">model: &#123;</span><br><span class="line">  <span class="comment">// 取值</span></span><br><span class="line">  get() &#123;</span><br><span class="line">    <span class="comment">// 被checkbox-group包裹则取store，当前value有值则取value否则selfModel</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.isGroup</span><br><span class="line">      ? <span class="keyword">this</span>.store : <span class="keyword">this</span>.value !== <span class="literal">undefined</span></span><br><span class="line">        ? <span class="keyword">this</span>.value : <span class="keyword">this</span>.selfModel;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 赋值</span></span><br><span class="line">  set(val) &#123;</span><br><span class="line">    <span class="comment">// 被checkbox-group包裹</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isGroup) &#123;</span><br><span class="line">      <span class="keyword">this</span>.isLimitExceeded = <span class="literal">false</span>;</span><br><span class="line">      <span class="comment">// 若赋值长度小于checkbox-group的min 突破限制</span></span><br><span class="line">      (<span class="keyword">this</span>._checkboxGroup.min !== <span class="literal">undefined</span> &amp;&amp;</span><br><span class="line">        val.length &lt; <span class="keyword">this</span>._checkboxGroup.min &amp;&amp;</span><br><span class="line">        (<span class="keyword">this</span>.isLimitExceeded = <span class="literal">true</span>));</span><br><span class="line">      <span class="comment">// 若赋值长度大于checkbox-group的max 突破限制</span></span><br><span class="line">      (<span class="keyword">this</span>._checkboxGroup.max !== <span class="literal">undefined</span> &amp;&amp;</span><br><span class="line">        val.length &gt; <span class="keyword">this</span>._checkboxGroup.max &amp;&amp;</span><br><span class="line">        (<span class="keyword">this</span>.isLimitExceeded = <span class="literal">true</span>));</span><br><span class="line">      <span class="comment">// 没有突破限制 向上找到checkbox-group组件发布input事件暴露val（数组形式）</span></span><br><span class="line">      <span class="keyword">this</span>.isLimitExceeded === <span class="literal">false</span> &amp;&amp;</span><br><span class="line">      <span class="keyword">this</span>.dispatch(<span class="string">'ElCheckboxGroup'</span>, <span class="string">'input'</span>, [val]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 没有被checkbox-group包裹 直接发布input事件暴露val</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, val);</span><br><span class="line">      <span class="comment">// 给selfModel赋值val</span></span><br><span class="line">      <span class="keyword">this</span>.selfModel = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>isLimitExceeded: 是否突破限制 与checkbox-group的min和max有关</li><li>selfModel: 没有在多选组中使用的model值，默认false</li></ul><h4 id="input的change事件"><a href="#input的change事件" class="headerlink" title="input的change事件"></a>input的change事件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// input的change事件</span></span><br><span class="line">handleChange(ev) &#123;</span><br><span class="line">  <span class="comment">// 突破限制 直接return</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.isLimitExceeded) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">let</span> value;</span><br><span class="line">  <span class="keyword">if</span> (ev.target.checked) &#123;</span><br><span class="line">    <span class="comment">// 被选中 给value赋值 有trueLabel则赋值trueLabel 无则赋值true</span></span><br><span class="line">    value = <span class="keyword">this</span>.trueLabel === <span class="literal">undefined</span> ? <span class="literal">true</span> : <span class="keyword">this</span>.trueLabel;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 未被选中 给value赋值 有falseLable则赋值falseLabel 无则false</span></span><br><span class="line">    value = <span class="keyword">this</span>.falseLabel === <span class="literal">undefined</span> ? <span class="literal">false</span> : <span class="keyword">this</span>.falseLabel;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 发布change方法暴露value及和event对象</span></span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, value, ev);</span><br><span class="line">  <span class="comment">// dom渲染完成后 如果被checkbox-group组件包裹 则发布change事件，暴露checkbox-group组件实例的value(数组)</span></span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isGroup) &#123;</span><br><span class="line">      <span class="keyword">this</span>.dispatch(<span class="string">'ElCheckboxGroup'</span>, <span class="string">'change'</span>, [<span class="keyword">this</span>._checkboxGroup.value]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="监听value，与表单验证相关"><a href="#监听value，与表单验证相关" class="headerlink" title="监听value，与表单验证相关"></a>监听value，与表单验证相关</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="comment">// 监听value变化，向上找到form组件则发布el.form.change事件暴露出value</span></span><br><span class="line">  value(value) &#123;</span><br><span class="line">    <span class="keyword">this</span>.dispatch(<span class="string">'ElFormItem'</span>, <span class="string">'el.form.change'</span>, value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>dispatch: 从mixins混入进来的方法,向上寻找(指定组件，发布指定事件，暴露指定值)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/src/mixins/emitter'</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="checkbox-button"><a href="#checkbox-button" class="headerlink" title="checkbox-button"></a>checkbox-button</h2><p><code>与checkbox基本一致，多了button相关样式,computed中的activeStyle，受checkbox-group的fill控制</code></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.hollytree.top/2018/09/10/拜读及分析Element源码-button组件篇/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="holly"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Holly-小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/09/10/拜读及分析Element源码-button组件篇/" itemprop="url">拜读及分析Element源码-button组件篇</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-10T14:12:50+08:00">2018-09-10</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/element-ui源码分析系列/" itemprop="url" rel="index"><span itemprop="name">element-ui源码分析系列</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">781 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">4 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>button组件开发时用到的频率非常高，一起来看看吧。</p></blockquote><p><img src="/2018/09/10/拜读及分析Element源码-button组件篇/c3393b292df5e0feb25d8e8b546034a85fdf729c.jpg" alt=""></p><p><code>button组件相关的有两个文件</code></p><h2 id="button-group（按钮组）"><a href="#button-group（按钮组）" class="headerlink" title="button-group（按钮组）"></a>button-group（按钮组）</h2><p><code>按钮组时使用，相当于button的一个父容器,内包含一个匿名插槽，具体的处理在button.vue中</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"el-button-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">    name: <span class="string">'ElButtonGroup'</span></span></span><br><span class="line"><span class="undefined">  &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="button-按钮"><a href="#button-按钮" class="headerlink" title="button (按钮)"></a>button (按钮)</h2><h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"el-button"</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">click</span>=<span class="string">"handleClick"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:disabled</span>=<span class="string">"buttonDisabled || loading"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:autofocus</span>=<span class="string">"autofocus"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:type</span>=<span class="string">"nativeType"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:class</span>=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">    type ? 'el-button--' + type : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">    buttonSize ? 'el-button--' + buttonSize : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-disabled': buttonDisabled,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-loading': loading,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-plain': plain,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-round': round,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-circle': circle</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">  ]"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- loading --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-loading"</span> <span class="attr">v-if</span>=<span class="string">"loading"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- icon --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">:class</span>=<span class="string">"icon"</span> <span class="attr">v-if</span>=<span class="string">"icon &amp;&amp; !loading"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 插槽 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">"$slots.default"</span>&gt;</span><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>button按钮<ul><li>属性：<ul><li>disabled：是否禁用</li><li>autofocus：是否获取焦点</li><li>type：赋值button的原生type（props中接收的nativeType）</li><li>class: 多条件动态显示（此处用数组嵌套对象的写法 <a href="https://cn.vuejs.org/v2/guide/class-and-style.html#%E6%95%B0%E7%BB%84%E8%AF%AD%E6%B3%95" target="_blank" rel="noopener">点击跳转官方文档</a>）</li></ul></li></ul></li><li>loading：props接收的loading为真时显示。</li><li>icon：props接收的icon为真并且loading为假时显示。</li><li>插槽：接收到匿名插槽内容时显示。(也就是使用button-group按钮组时)</li></ul><h3 id="inject-接收form组件注入的属性"><a href="#inject-接收form组件注入的属性" class="headerlink" title="inject: 接收form组件注入的属性"></a>inject: 接收form组件注入的属性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inject: &#123;</span><br><span class="line">  elForm: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  elFormItem: &#123;</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里接收默认为空</p><p>如果button组件在form组件内使用，若form向子孙后代注入某些属性。会影响button的一些样式（本组件computed 中可以看到）。</p><p><a href="https://cn.vuejs.org/v2/api/#provide-inject" target="_blank" rel="noopener">点击查看官方文档: provide 和 inject</a></p><p><code>那么问题来了，有props为什么还要用 provide 和 inject 呢，因为前者只能用于父子，后者可以子孙后代，层级更深</code></p><h3 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  _elFormItemSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.elFormItem || &#123;&#125;).elFormItemSize;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 大小样式由props接收的size和formItem组件注入的size以及全局配置对象（$ELEMENT，此对象由引入时Vue.use()传入的默认空对象）的size决定</span></span><br><span class="line">  buttonSize() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size || <span class="keyword">this</span>._elFormItemSize || (<span class="keyword">this</span>.$ELEMENT || &#123;&#125;).size;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// props接收disabled以及form组件注入的disabled决定（loading时也禁止↑）</span></span><br><span class="line">  buttonDisabled() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.disabled || (<span class="keyword">this</span>.elForm || &#123;&#125;).disabled;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><strong>size</strong>的影响因素</p><ul><li><p>props接收的size</p></li><li><p>form组件<strong>provide</strong> 的size</p></li><li><p>全局配置对象<strong>$ELEMENT</strong>的size： vue.use()时传入的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> Element <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line">Vue.use(Element, &#123; <span class="attr">size</span>: <span class="string">'small'</span>, <span class="attr">zIndex</span>: <span class="number">3000</span> &#125;);</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>disabled</strong>的影响因素</p><ul><li><p>props接收的disabled</p></li><li><p>form组件<strong>provide</strong> 的disabled</p></li></ul></li></ul><h3 id="事件methods"><a href="#事件methods" class="headerlink" title="事件methods"></a>事件methods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">// 点击button向父组件暴露点击事件</span></span><br><span class="line">  handleClick(evt) &#123;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'click'</span>, evt);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>可以结合element文档看</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 按钮主题样式</span></span><br><span class="line">  type: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">'default'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 按钮大小</span></span><br><span class="line">  size: <span class="built_in">String</span>,</span><br><span class="line">  <span class="comment">// icon</span></span><br><span class="line">  icon: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 原生button属性</span></span><br><span class="line">  nativeType: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">'button'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 按钮的loding动画</span></span><br><span class="line">  loading: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 禁用</span></span><br><span class="line">  disabled: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 朴素样式</span></span><br><span class="line">  plain: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 聚焦</span></span><br><span class="line">  autofocus: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 圆角</span></span><br><span class="line">  round: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 圆形</span></span><br><span class="line">  circle: <span class="built_in">Boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><ul><li>slot的使用：<a href="https://cn.vuejs.org/v2/guide/components-slots.html#%E5%85%B7%E5%90%8D%E6%8F%92%E6%A7%BD" target="_blank" rel="noopener">插槽</a></li><li>动态class <a href="https://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="noopener">class绑定传送门</a><ul><li>数组写法</li><li>对象写法</li><li>更复杂的情况可以用数组组合对象的写法</li></ul></li><li>$slots.default ： 获取所有匿名插槽分发的内容 <a href="https://cn.vuejs.org/v2/api/#vm-slots" target="_blank" rel="noopener">$slots官方传送门</a></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.hollytree.top/2018/09/07/拜读及分析Element源码-alert组件篇/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="holly"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Holly-小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/09/07/拜读及分析Element源码-alert组件篇/" itemprop="url">拜读及分析Element源码-alert组件篇</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-07T17:51:09+08:00">2018-09-07</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/element-ui源码分析系列/" itemprop="url" rel="index"><span itemprop="name">element-ui源码分析系列</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">728 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">3 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>alert组件比较简单，基本上就是展示不同的样式， 只有一个关闭事件。</p></blockquote><p><img src="/2018/09/07/拜读及分析Element源码-alert组件篇/ef592846f21fbe09fce004156c600c338644ad8c.jpg" alt=""></p><h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"el-alert-fade"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    typeClass：根据传入的type控制样式</span></span><br><span class="line"><span class="comment">    center: 根据传入的center控制内容是否居中</span></span><br><span class="line"><span class="comment">    role：属性作用是告诉Accessibility类应用（比如屏幕朗读程序，为盲人提供的访问网络的便利程序），这个元素所扮演的角色，主要是供残疾人使用。使用role可以增强文本的可读性和语义化。 </span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"el-alert"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:class</span>=<span class="string">"[typeClass, center ? 'is-center' : '']"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-show</span>=<span class="string">"visible"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">role</span>=<span class="string">"alert"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">      showIcon: 控制是否显示icon</span></span><br><span class="line"><span class="comment">      iconClass: 根据传入的type动态控制icon的样式</span></span><br><span class="line"><span class="comment">      isBigIcon： 如果传入了description（辅助性文字）或者 插槽内传入了内容 则显示大icon</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-alert__icon"</span> <span class="attr">:class</span>=<span class="string">"[ iconClass, isBigIcon ]"</span> <span class="attr">v-if</span>=<span class="string">"showIcon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"el-alert__content"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 如果传入了description（辅助性文字）或者 传入了匿名插槽 则显示加粗title --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-alert__title"</span> <span class="attr">:class</span>=<span class="string">"[ isBoldTitle ]"</span> <span class="attr">v-if</span>=<span class="string">"title"</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 传入插槽内容则显示插槽内容 未传入默认显示slot内的内容description --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"el-alert__description"</span> <span class="attr">v-if</span>=<span class="string">"description"</span>&gt;</span>&#123;&#123; description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">        closable: 是否显示关闭按钮，默认显示</span></span><br><span class="line"><span class="comment">        closeText： 关闭按钮自定义文字，无显示X有显示文字</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-alert__closebtn"</span> <span class="attr">:class</span>=<span class="string">"&#123; 'is-customed': closeText !== '', 'el-icon-close': closeText === '' &#125;"</span> <span class="attr">v-show</span>=<span class="string">"closable"</span> @<span class="attr">click</span>=<span class="string">"close()"</span>&gt;</span>&#123;&#123;closeText&#125;&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 接收标题</span></span><br><span class="line">  title: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 辅助性文字</span></span><br><span class="line">  description: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 接收主题 computed里会根据不同type返回对应的样式</span></span><br><span class="line">  type: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">'info'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 关闭按钮显示</span></span><br><span class="line">  closable: &#123;</span><br><span class="line">    type: <span class="built_in">Boolean</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 关闭按钮自定义文字</span></span><br><span class="line">  closeText: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 是否显示icom</span></span><br><span class="line">  showIcon: <span class="built_in">Boolean</span>,</span><br><span class="line">  <span class="comment">// 内容是否居中</span></span><br><span class="line">  center: <span class="built_in">Boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">// alert的样式</span></span><br><span class="line">  typeClass() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`el-alert--<span class="subst">$&#123;<span class="keyword">this</span>.type&#125;</span>`</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// alert里icon的样式</span></span><br><span class="line">  iconClass() &#123;</span><br><span class="line">    <span class="keyword">return</span> TYPE_CLASSES_MAP[<span class="keyword">this</span>.type] || <span class="string">'el-icon-info'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 如果传入了description（辅助性文字）或者 传入了匿名插槽 则显示大icon</span></span><br><span class="line">  isBigIcon() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.description || <span class="keyword">this</span>.$slots.default ? <span class="string">'is-big'</span> : <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 如果传入了description（辅助性文字）或者 传入了匿名插槽 则显示加粗title</span></span><br><span class="line">  isBoldTitle() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.description || <span class="keyword">this</span>.$slots.default ? <span class="string">'is-bold'</span> : <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="methods"><a href="#methods" class="headerlink" title="methods"></a>methods</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">// 关闭alert方法</span></span><br><span class="line">  close() &#123;</span><br><span class="line">    <span class="comment">// v-show隐藏alert</span></span><br><span class="line">    <span class="keyword">this</span>.visible = <span class="literal">false</span></span><br><span class="line">    <span class="comment">// 向父组件暴露close方法</span></span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'close'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="data"><a href="#data" class="headerlink" title="data"></a>data</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 组件显示隐藏</span></span><br><span class="line">    visible: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><ul><li>动态class <a href="https://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="noopener">class绑定传送门</a><ul><li>数组写法</li><li>对象写法</li><li>更复杂的情况可以用数组组合对象的写法</li></ul></li><li>role属性：无障碍网页应用,读屏软件会用到。<a href="https://www.w3.org/TR/2014/REC-wai-aria-implementation-20140320/#mapping_role" target="_blank" rel="noopener">W3c传送门</a></li><li>$slots.default ： 获取所有匿名插槽分发的内容 <a href="https://cn.vuejs.org/v2/api/#vm-slots" target="_blank" rel="noopener">$slots官方传送门</a></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.hollytree.top/2018/08/30/拜读及分析Element源码-input组件篇/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="holly"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Holly-小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/2018/08/30/拜读及分析Element源码-input组件篇/" itemprop="url">拜读及分析Element源码组件-input篇</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-30T10:07:48+08:00">2018-08-30</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/element-ui源码分析系列/" itemprop="url" rel="index"><span itemprop="name">element-ui源码分析系列</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2,676 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">12 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>element-ui源码详细分析以及在其中可以学到的东西整理。(有问题欢迎指正与讨论)</p></blockquote><p><img src="/2018/08/30/拜读及分析Element源码-input组件篇/fa1b71cf3bc79f3dab9ce2bab2a1cd11738b29e4.jpg" alt=""></p><h2 id="首先看生命周期做了什么"><a href="#首先看生命周期做了什么" class="headerlink" title="首先看生命周期做了什么"></a>首先看生命周期做了什么</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="comment">// 与select组件相关联 (若select组件已发布inputSelect事件则触发选中)</span></span><br><span class="line">  <span class="keyword">this</span>.$on(<span class="string">'inputSelect'</span>, <span class="keyword">this</span>.select);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">mounted() &#123;</span><br><span class="line">  <span class="comment">// 动态文本域（高度）</span></span><br><span class="line">  <span class="keyword">this</span>.resizeTextarea();</span><br><span class="line">  <span class="comment">// 前置后置元素偏移（样式）</span></span><br><span class="line">  <span class="keyword">this</span>.updateIconOffset();</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">updated() &#123;</span><br><span class="line">  <span class="comment">// 视图重绘完毕后 前置后置偏移（样式）</span></span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="keyword">this</span>.updateIconOffset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="外层DIV绑定的一些class"><a href="#外层DIV绑定的一些class" class="headerlink" title="外层DIV绑定的一些class"></a>外层DIV绑定的一些class</h2><p>插槽及一些props传入的参数控制外层样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">    type === 'textarea' ? 'el-textarea' : 'el-input',</span></span></span><br><span class="line"><span class="tag"><span class="string">    inputSize ? 'el-input--' + inputSize : '',</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">      'is-disabled': inputDisabled,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'el-input-group': $slots.prepend || $slots.append,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'el-input-group--append': $slots.append,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'el-input-group--prepend': $slots.prepend,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'el-input--prefix': $slots.prefix || prefixIcon,</span></span></span><br><span class="line"><span class="tag"><span class="string">      'el-input--suffix': $slots.suffix || suffixIcon || clearable</span></span></span><br><span class="line"><span class="tag"><span class="string">    &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">    ]"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">mouseenter</span>=<span class="string">"hovering = true"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">mouseleave</span>=<span class="string">"hovering = false"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 内部被分为</span></span><br><span class="line"><span class="comment">	input结构 与 textarea结构 </span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">  动态class</span></span><br><span class="line"><span class="comment">    具名插槽</span></span><br><span class="line"><span class="comment">      $slots.prepend: 前置插槽</span></span><br><span class="line"><span class="comment">      $slots.append: 后置插槽</span></span><br><span class="line"><span class="comment">      $slots.prefix： 前置icon插槽</span></span><br><span class="line"><span class="comment">      $slots.suffix： 后置icon插槽</span></span><br><span class="line"><span class="comment">    不使用插槽的icon</span></span><br><span class="line"><span class="comment">      prefixIcon: 前置icon</span></span><br><span class="line"><span class="comment">      suffixIcon: 后置icon</span></span><br><span class="line"><span class="comment">      clearable： 后置是否清空</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="实例属性-slots用来访问被插槽分发的内容"><a href="#实例属性-slots用来访问被插槽分发的内容" class="headerlink" title="实例属性$slots用来访问被插槽分发的内容"></a>实例属性$slots用来访问被<strong>插槽分发</strong>的内容</h3><ul><li>vm.$slots.foo 访问具名插槽foo</li><li>vm.$slots.default 没有被包含在具名插槽中的节点</li></ul><h3 id="有多个条件-class-时"><a href="#有多个条件-class-时" class="headerlink" title="有多个条件 class 时:"></a>有多个条件 class 时:</h3><ul><li>可以用<strong>数组结合对象</strong>的写法</li></ul><h2 id="内层input结构"><a href="#内层input结构" class="headerlink" title="内层input结构"></a>内层input结构</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 输入框结构 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"type !== 'textarea'"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 前置元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"el-input-group__prepend"</span> <span class="attr">v-if</span>=<span class="string">"$slots.prepend"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:tabindex</span>=<span class="string">"tabindex"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">"type !== 'textarea'"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"el-input__inner"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-bind</span>=<span class="string">"$attrs"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:type</span>=<span class="string">"type"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:disabled</span>=<span class="string">"inputDisabled"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:readonly</span>=<span class="string">"readonly"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:autocomplete</span>=<span class="string">"autoComplete"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:value</span>=<span class="string">"currentValue"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">"input"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">compositionstart</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">compositionupdate</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">compositionend</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">input</span>=<span class="string">"handleInput"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">focus</span>=<span class="string">"handleFocus"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">blur</span>=<span class="string">"handleBlur"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">change</span>=<span class="string">"handleChange"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:aria-label</span>=<span class="string">"label"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 前置内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"el-input__prefix"</span> <span class="attr">v-if</span>=<span class="string">"$slots.prefix || prefixIcon"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 后置内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"el-input__suffix"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">"$slots.suffix || suffixIcon || showClear || validateState &amp;&amp; needStatusIcon"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 后置元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"el-input-group__append"</span> <span class="attr">v-if</span>=<span class="string">"$slots.append"</span>&gt;</span></span><br><span class="line">      ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>前置后置内容及插槽</strong>：基本上都是通过props接收的变量或者插槽控制样式及位置偏移，这里我就先“…”了</p><h3 id="中文输入法相关的事件"><a href="#中文输入法相关的事件" class="headerlink" title="中文输入法相关的事件"></a>中文输入法相关的事件</h3><ul><li>compositionstart</li><li>compositionupdate</li><li>compositionend</li></ul><p>首先会看到input上绑定了这三个事件（<strong>在下孤陋寡闻没有见过</strong>）,于是<strong>尝试一下触发时机</strong></p><p><img src="/2018/08/30/拜读及分析Element源码-input组件篇/拜读ElementUi源码-input篇/assd.gif" alt=""></p><p>根据上图可以看到</p><ul><li>输入到input框触发<strong>input</strong>事件</li><li>失去焦点后内容有改变触发<strong>change</strong>事件</li><li>识别到你开始使用中文输入法触发<strong>compositionstart</strong> 事件</li><li>未输入结束但还在输入中触发<strong>compositionupdate</strong> 事件</li><li>输入完成（也就是我们回车或者选择了对应的文字插入到输入框的时刻）触发<strong>compositionend</strong>事件。</li></ul><p>查阅资料后发现，这三个事件<strong>不仅包括中文输入法还包括语音识别</strong>。</p><p>下面是MDN上的解释</p><blockquote><p>类似于 <code>keydown</code> 事件，但是该事件仅在若干可见字符的输入之前，而这些可见字符的输入可能需要一连串的键盘操作、语音识别或者点击输入法的备选词</p></blockquote><h4 id="那么问题来了-为什么要使用这几个事件呢"><a href="#那么问题来了-为什么要使用这几个事件呢" class="headerlink" title="那么问题来了 为什么要使用这几个事件呢"></a>那么问题来了 为什么要使用这几个事件呢</h4><p>因为input组件常常跟form表单一起出现，需要做表单验证</p><p><img src="/2018/08/30/拜读及分析Element源码-input组件篇/拜读ElementUi源码-input篇/input-event-issue.png" alt=""></p><p>为了解决中文输入法输入内容时还没将中文插入到输入框就验证的问题</p><p>我们希望<strong>中文输入完成以后才验证</strong></p><h3 id="不曾用过的属性"><a href="#不曾用过的属性" class="headerlink" title="不曾用过的属性"></a>不曾用过的属性</h3><p>特指本渣눈.눈</p><ul><li><strong>$attrs</strong>: 获取到子组件props没有注册的,除了style和class以外所有父组件的属性。（感觉好强!）</li><li><strong>tabindex</strong>: 原生属性, 元素的 tab 键控制次序(具体的自行查阅)</li><li><strong>readonly</strong> ：原生属性，只读。（true时input框不可修改）</li><li><strong>autoComplete</strong>：原生属性 当用户在字段开始键入时，浏览器基于之前键入过的值，是否显示出在字段中填写的选项。</li><li><strong>aria-label</strong>：原生属性，tab到输入框时，读屏软件就会读出相应label里的文本。</li></ul><h2 id="内层textarea-结构"><a href="#内层textarea-结构" class="headerlink" title="内层textarea 结构"></a>内层textarea 结构</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文本域结构 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">textarea</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:tabindex</span>=<span class="string">"tabindex"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"el-textarea__inner"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:value</span>=<span class="string">"currentValue"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">compositionstart</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">compositionupdate</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">compositionend</span>=<span class="string">"handleComposition"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">input</span>=<span class="string">"handleInput"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"textarea"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-bind</span>=<span class="string">"$attrs"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:disabled</span>=<span class="string">"inputDisabled"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:readonly</span>=<span class="string">"readonly"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:style</span>=<span class="string">"textareaStyle"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">focus</span>=<span class="string">"handleFocus"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">blur</span>=<span class="string">"handleBlur"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">change</span>=<span class="string">"handleChange"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:aria-label</span>=<span class="string">"label"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><p>绑定的事件及属性与input差不多，区别是textarea动态控制高度的style</p><h3 id="textarea-高度自适应"><a href="#textarea-高度自适应" class="headerlink" title="textarea 高度自适应"></a>textarea 高度自适应</h3><p>props</p><ul><li>autosize 自适应高度的配置</li><li>resize 是否缩放</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">	textareaStyle() &#123;</span><br><span class="line">        <span class="comment">// merge 从src/utils/merge.js引入 合并对象的方法</span></span><br><span class="line">		<span class="keyword">return</span> merge(&#123;&#125;, <span class="keyword">this</span>.textareaCalcStyle, &#123; <span class="attr">resize</span>: <span class="keyword">this</span>.resize &#125;);</span><br><span class="line">	&#125;,	</span><br><span class="line">&#125;，</span><br><span class="line">methods: &#123;</span><br><span class="line">     resizeTextarea() &#123;</span><br><span class="line">        <span class="comment">// 是否运行于服务器 （服务器渲染）</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.$isServer) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">const</span> &#123; autosize, type &#125; = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (type !== <span class="string">'textarea'</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (!autosize) &#123;</span><br><span class="line">          <span class="keyword">this</span>.textareaCalcStyle = &#123;</span><br><span class="line">            minHeight: calcTextareaHeight(<span class="keyword">this</span>.$refs.textarea).minHeight</span><br><span class="line">          &#125;;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> minRows = autosize.minRows;</span><br><span class="line">        <span class="keyword">const</span> maxRows = autosize.maxRows;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.textareaCalcStyle = calcTextareaHeight(<span class="keyword">this</span>.$refs.textarea, 		minRows, maxRows);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>calcTextareaHeight 是<strong>calcTextareaHeight.js</strong>里的方法，计算文本域高度及设置样式</p><p>我就直接贴代码和分析的注释了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hiddenTextarea;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 预设的一些样式</span></span><br><span class="line"><span class="keyword">const</span> HIDDEN_STYLE = <span class="string">`</span></span><br><span class="line"><span class="string">  height:0 !important;</span></span><br><span class="line"><span class="string">  visibility:hidden !important;</span></span><br><span class="line"><span class="string">  overflow:hidden !important;</span></span><br><span class="line"><span class="string">  position:absolute !important;</span></span><br><span class="line"><span class="string">  z-index:-1000 !important;</span></span><br><span class="line"><span class="string">  top:0 !important;</span></span><br><span class="line"><span class="string">  right:0 !important</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 预计要用的一些样式属性</span></span><br><span class="line"><span class="keyword">const</span> CONTEXT_STYLE = [</span><br><span class="line">  <span class="string">'letter-spacing'</span>,</span><br><span class="line">  <span class="string">'line-height'</span>,</span><br><span class="line">  <span class="string">'padding-top'</span>,</span><br><span class="line">  <span class="string">'padding-bottom'</span>,</span><br><span class="line">  <span class="string">'font-family'</span>,</span><br><span class="line">  <span class="string">'font-weight'</span>,</span><br><span class="line">  <span class="string">'font-size'</span>,</span><br><span class="line">  <span class="string">'text-rendering'</span>,</span><br><span class="line">  <span class="string">'text-transform'</span>,</span><br><span class="line">  <span class="string">'width'</span>,</span><br><span class="line">  <span class="string">'text-indent'</span>,</span><br><span class="line">  <span class="string">'padding-left'</span>,</span><br><span class="line">  <span class="string">'padding-right'</span>,</span><br><span class="line">  <span class="string">'border-width'</span>,</span><br><span class="line">  <span class="string">'box-sizing'</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取到一些需要用到的样式</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculateNodeStyling</span>(<span class="params">targetElement</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 获取最终作用到元素的所有样式（返回CSSStyleDeclaration对象）</span></span><br><span class="line">  <span class="keyword">const</span> style = <span class="built_in">window</span>.getComputedStyle(targetElement);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getPropertyValue为CSSStyleDeclaration原型上的方法获取到具体的样式</span></span><br><span class="line">  <span class="keyword">const</span> boxSizing = style.getPropertyValue(<span class="string">'box-sizing'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 上下内边距</span></span><br><span class="line">  <span class="keyword">const</span> paddingSize = (</span><br><span class="line">    <span class="built_in">parseFloat</span>(style.getPropertyValue(<span class="string">'padding-bottom'</span>)) +</span><br><span class="line">    <span class="built_in">parseFloat</span>(style.getPropertyValue(<span class="string">'padding-top'</span>))</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 上下边框宽度</span></span><br><span class="line">  <span class="keyword">const</span> borderSize = (</span><br><span class="line">    <span class="built_in">parseFloat</span>(style.getPropertyValue(<span class="string">'border-bottom-width'</span>)) +</span><br><span class="line">    <span class="built_in">parseFloat</span>(style.getPropertyValue(<span class="string">'border-top-width'</span>))</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 取出预计要用的属性名和值，以分号拼接成字符串</span></span><br><span class="line">  <span class="keyword">const</span> contextStyle = CONTEXT_STYLE</span><br><span class="line">    .map(<span class="function"><span class="params">name</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>:<span class="subst">$&#123;style.getPropertyValue(name)&#125;</span>`</span>)</span><br><span class="line">    .join(<span class="string">';'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回预设要用的样式字符串，上下内边距和， 边框和， boxSizing属性值</span></span><br><span class="line">  <span class="keyword">return</span> &#123; contextStyle, paddingSize, borderSize, boxSizing &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">calcTextareaHeight</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  targetElement,</span></span></span><br><span class="line"><span class="function"><span class="params">  minRows = <span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  maxRows = null</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// hiddenTextarea不存在则创建textarea元素append到body中</span></span><br><span class="line">  <span class="keyword">if</span> (!hiddenTextarea) &#123;</span><br><span class="line">    hiddenTextarea = <span class="built_in">document</span>.createElement(<span class="string">'textarea'</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(hiddenTextarea);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 取出以下属性值</span></span><br><span class="line">  <span class="keyword">let</span> &#123;</span><br><span class="line">    paddingSize,</span><br><span class="line">    borderSize,</span><br><span class="line">    boxSizing,</span><br><span class="line">    contextStyle</span><br><span class="line">  &#125; = calculateNodeStyling(targetElement);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 给创建的hiddenTextarea添加行内样式并赋值value或palceholder,无则''</span></span><br><span class="line">  hiddenTextarea.setAttribute(<span class="string">'style'</span>, <span class="string">`<span class="subst">$&#123;contextStyle&#125;</span>;<span class="subst">$&#123;HIDDEN_STYLE&#125;</span>`</span>);</span><br><span class="line">  hiddenTextarea.value = targetElement.value || targetElement.placeholder || <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取元素自身高度</span></span><br><span class="line">  <span class="keyword">let</span> height = hiddenTextarea.scrollHeight;</span><br><span class="line">  <span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// boxSizing不同 高度计算不同</span></span><br><span class="line">  <span class="keyword">if</span> (boxSizing === <span class="string">'border-box'</span>) &#123;</span><br><span class="line">    <span class="comment">// border-box：高度 = 元素自身高度 + 上下边框宽度和</span></span><br><span class="line">    height = height + borderSize;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (boxSizing === <span class="string">'content-box'</span>) &#123;</span><br><span class="line">    <span class="comment">// content-box： 高度 = 高度 - 上下内边距和</span></span><br><span class="line">    height = height - paddingSize;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  hiddenTextarea.value = <span class="string">''</span>;</span><br><span class="line">  <span class="comment">// 单行文字的高度</span></span><br><span class="line">  <span class="keyword">let</span> singleRowHeight = hiddenTextarea.scrollHeight - paddingSize;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// minRows最小行存在</span></span><br><span class="line">  <span class="keyword">if</span> (minRows !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 最小高度 = 单行高度 * 行数</span></span><br><span class="line">    <span class="keyword">let</span> minHeight = singleRowHeight * minRows;</span><br><span class="line">    <span class="keyword">if</span> (boxSizing === <span class="string">'border-box'</span>) &#123;</span><br><span class="line">      <span class="comment">// border-box则加上内边距及边框</span></span><br><span class="line">      minHeight = minHeight + paddingSize + borderSize;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// minHeight与height取最大值给height赋值</span></span><br><span class="line">    height = <span class="built_in">Math</span>.max(minHeight, height);</span><br><span class="line">    result.minHeight = <span class="string">`<span class="subst">$&#123; minHeight &#125;</span>px`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 最大行存在</span></span><br><span class="line">  <span class="keyword">if</span> (maxRows !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// 逻辑同上</span></span><br><span class="line">    <span class="keyword">let</span> maxHeight = singleRowHeight * maxRows;</span><br><span class="line">    <span class="keyword">if</span> (boxSizing === <span class="string">'border-box'</span>) &#123;</span><br><span class="line">      maxHeight = maxHeight + paddingSize + borderSize;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// maxHeight与height取最小值给height赋值</span></span><br><span class="line">    height = <span class="built_in">Math</span>.min(maxHeight, height);</span><br><span class="line">  &#125;</span><br><span class="line">  result.height = <span class="string">`<span class="subst">$&#123; height &#125;</span>px`</span>;</span><br><span class="line">  <span class="comment">// 计算完成后移除hiddenTextarea元素</span></span><br><span class="line">  hiddenTextarea.parentNode &amp;&amp; hiddenTextarea.parentNode.removeChild(hiddenTextarea);</span><br><span class="line">  hiddenTextarea = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 暴露包含minHeight及height的对象</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="需要注意的一些点"><a href="#需要注意的一些点" class="headerlink" title="需要注意的一些点"></a>需要注意的一些点</h2><h3 id="form组件中嵌套input组件时样式也会受form一些注入属性的控制。"><a href="#form组件中嵌套input组件时样式也会受form一些注入属性的控制。" class="headerlink" title="form组件中嵌套input组件时样式也会受form一些注入属性的控制。"></a><strong>form</strong>组件中嵌套input组件时样式也会受form一些注入属性的控制。</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收form组件注入的属性</span></span><br><span class="line">   inject: &#123;</span><br><span class="line">     elForm: &#123;</span><br><span class="line">       <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">     &#125;,</span><br><span class="line">     elFormItem: &#123;</span><br><span class="line">       <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><ul><li><p>size(input的大小)</p></li><li><p>this.elFormItem.validateState： 与表单验证关联 ，控制表单验证时icon的样式（红x之类的）</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    <span class="comment">// 表单验证相关</span></span><br><span class="line">    validateState() &#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="keyword">this</span>.elFormItem ? <span class="keyword">this</span>.elFormItem.validateState : <span class="string">''</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    needStatusIcon() &#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="keyword">this</span>.elForm ? <span class="keyword">this</span>.elForm.statusIcon : <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 表单验证样式</span></span><br><span class="line">    validateIcon() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">        validating: <span class="string">'el-icon-loading'</span>,</span><br><span class="line">        success: <span class="string">'el-icon-circle-check'</span>,</span><br><span class="line">        error: <span class="string">'el-icon-circle-close'</span></span><br><span class="line">        &#125;[<span class="keyword">this</span>.validateState];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="props的validateEvent属性：时间选择器会传入false其他默认true-（意思大概true是需要做校验）-以下是用到validateEvent的methods"><a href="#props的validateEvent属性：时间选择器会传入false其他默认true-（意思大概true是需要做校验）-以下是用到validateEvent的methods" class="headerlink" title="props的validateEvent属性：时间选择器会传入false其他默认true （意思大概true是需要做校验）,以下是用到validateEvent的methods"></a>props的<strong>validateEvent</strong>属性：时间选择器会传入false其他默认true （意思大概true是需要做校验）,以下是用到<strong>validateEvent</strong>的methods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">handleBlur(event) &#123;</span><br><span class="line">  <span class="keyword">this</span>.focused = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// 暴露blur事件</span></span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">'blur'</span>, event);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.validateEvent) &#123;</span><br><span class="line">    <span class="comment">// 向上找到ElFormItem组件发布el.form.blur事件并传值</span></span><br><span class="line">    <span class="keyword">this</span>.dispatch(<span class="string">'ElFormItem'</span>, <span class="string">'el.form.blur'</span>, [<span class="keyword">this</span>.currentValue]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">setCurrentValue(value) &#123;</span><br><span class="line">  <span class="comment">// 还在输入并且内容与之前内容相同 return</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.isOnComposition &amp;&amp; value === <span class="keyword">this</span>.valueBeforeComposition) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">// input内容赋值</span></span><br><span class="line">  <span class="keyword">this</span>.currentValue = value;</span><br><span class="line">  <span class="comment">// 还在输入return</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.isOnComposition) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">_</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.resizeTextarea();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 除了时间选择器其他组件中使用默认为true</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.validateEvent) &#123;</span><br><span class="line">    <span class="comment">// mixin中的方法 意思是向上找到ElFormItem组件发布el.form.change事件并传递当前input内容</span></span><br><span class="line">    <span class="keyword">this</span>.dispatch(<span class="string">'ElFormItem'</span>, <span class="string">'el.form.change'</span>, [value]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="dispatch这个方法开始我以为是触发vuex的方法结果是mixin里的"><a href="#dispatch这个方法开始我以为是触发vuex的方法结果是mixin里的" class="headerlink" title="dispatch这个方法开始我以为是触发vuex的方法结果是mixin里的"></a><strong>dispatch</strong>这个方法开始我以为是触发vuex的方法结果是<strong>mixin</strong>里的</h4><p>路径： <strong>src/mixins/emitter.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收组件名，事件名，参数</span></span><br><span class="line">dispatch(componentName, eventName, params) &#123;</span><br><span class="line">    <span class="keyword">var</span> parent = <span class="keyword">this</span>.$parent || <span class="keyword">this</span>.$root;</span><br><span class="line">    <span class="keyword">var</span> name = parent.$options.componentName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 寻找父级，如果父级不是符合的组件名，则循环向上查找</span></span><br><span class="line">    <span class="keyword">while</span> (parent &amp;&amp; (!name || name !== componentName)) &#123;</span><br><span class="line">        parent = parent.$parent;</span><br><span class="line">        <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">            name = parent.$options.componentName;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 找到符合组件名称的父级后，发布传入事件。</span></span><br><span class="line">    <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">        parent.$emit.apply(parent, [eventName].concat(params));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="导入的Migrating"><a href="#导入的Migrating" class="headerlink" title="导入的Migrating"></a>导入的Migrating</h3><p>迭代api友好提示 方便由于用了移除的api报错 找出问题在哪 参见methos中<strong>getMigratingConfig</strong>事件及<strong>src/mixins/migrating.js</strong></p><h2 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断韩文的方法(不清楚为什么)</span></span><br><span class="line"><span class="keyword">import</span> &#123; isKorean &#125; <span class="keyword">from</span> <span class="string">'element-ui/src/utils/shared'</span>;</span><br><span class="line"></span><br><span class="line">methods: &#123;</span><br><span class="line">    <span class="comment">// 中文或语音输入开始 中 后 触发详见↑</span></span><br><span class="line">    handleComposition(event) &#123;</span><br><span class="line">        <span class="comment">// 完成输入时</span></span><br><span class="line">        <span class="keyword">if</span> (event.type === <span class="string">'compositionend'</span>) &#123;</span><br><span class="line">            <span class="comment">// 输入中标识为false</span></span><br><span class="line">            <span class="keyword">this</span>.isOnComposition = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// 中文或语音输入前的值赋值给当前</span></span><br><span class="line">            <span class="keyword">this</span>.currentValue = <span class="keyword">this</span>.valueBeforeComposition;</span><br><span class="line">            <span class="comment">// 清空之前的值</span></span><br><span class="line">            <span class="keyword">this</span>.valueBeforeComposition = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">// 赋值并且向父组件暴露input方法</span></span><br><span class="line">            <span class="keyword">this</span>.handleInput(event);</span><br><span class="line">            <span class="comment">// 未完成时</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> text = event.target.value;</span><br><span class="line">            <span class="keyword">const</span> lastCharacter = text[text.length - <span class="number">1</span>] || <span class="string">''</span>;</span><br><span class="line">            <span class="comment">// 最后一个字符不是韩文就是在输入中（不是很理解为什么要判断最后一个字符是否是韩语）</span></span><br><span class="line">            <span class="keyword">this</span>.isOnComposition = !isKorean(lastCharacter);</span><br><span class="line">            <span class="comment">// 输入开始前</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.isOnComposition &amp;&amp; event.type === <span class="string">'compositionstart'</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.valueBeforeComposition = text;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"> <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="holly"><p class="site-author-name" itemprop="name">holly</p><p class="site-description motion-element" itemprop="description">加油</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">35</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">11</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">35</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/hollyDysania" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="holly_dysania@sina.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://segmentfault.com/search?q=vue" title="segmentfault-vue" target="_blank">segmentfault-vue</a></li><li class="links-of-blogroll-item"> <a href="https://juejin.im/search?query=vue" title="掘金-vue" target="_blank">掘金-vue</a></li><li class="links-of-blogroll-item"> <a href="https://www.xiuyuan.info/" title="漫步编程" target="_blank">漫步编程</a></li></ul></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">holly</span> <span class="post-meta-divider">|</span> <span>Hosted by <a href="https://pages.coding.me" style="font-weight:700">Coding Pages</a></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">46.8k</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"left",bottom:0,width:90,height:180},mobile:{show:!1},log:!1})</script></body></html>